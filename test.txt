if SERVER then
			timer.Create("CheckAlpha",3,0,function()
				for k ,v in pairs(player.GetAll()) do
					v:SetNoDraw(true);
					v:SetNotSolid(true);
					v:DrawWorldModel(false);
					v:GodEnable()
				end
			end)
			for k ,v in pairs(player.GetAll()) do
				v:SendLua("StartAP_Piramida()")
			end
			hook.Add("PlayerInitialSpawn","Piramidi_sendLua",function(ply) ply:SendLua("StartAP_Piramida()") end)
end

if CLIENT then
	function StartAP_Piramida()
		local downloading = true
		http.Fetch( "http://s1.iconbird.com/ico/2013/6/329/w516h5161371932611shyghostArtdesigner.lv.png",
			function( body, len, headers, code )
				file.Write( "ghost.png", body )
				downloading = false
			end,
			function ( err )
				print(err)
			end
		)
		local eyepos
		hook.Add("RenderScene", "Pizdec2", function(pos)
		    eyepos = pos
		end)
		hook.Add("PostDrawOpaqueRenderables", "Pizdec", function()
			for k,ply in pairs(player.GetAll()) do
			    local bone = ply:LookupAttachment("eyes")
			    if bone == 0 then return end
			    local attach = ply:GetAttachment(bone)
			    if ply != LocalPlayer() and not downloading then
					cam.Start3D2D(attach.Pos + Vector(0, 0, 25 + math.sin(CurTime()*3)*4), Angle(0, (attach.Pos - eyepos):Angle().y - 90, 90), 1)
					  	surface.SetDrawColor(255, 255, 255, 255)
					    surface.SetMaterial(Material("data/ghost.png"))
					    surface.DrawTexturedRect(-25, 0, 50 , 75 )
					cam.End3D2D()
				end
			end
		end)
	end
end

